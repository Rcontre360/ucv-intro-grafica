# ðŸ”¨ Simple Makefile for Proyecto1 C++ Project (x64 Debug)

# --- Configuration Variables ---

# Compiler to use
CXX = g++

# Compiler flags: C++17 standard, enable all warnings, debug symbols, and C++ source type
CXXFLAGS = -std=c++17 -Wall -Wextra -pedantic -O3 -x c++

# CORRECTED Include directories: Restored full list of includes from vcxproj, 
# ensuring all directories needed for header search are present.
INCLUDES = -I./include \
           -I./include/stb \
           -I./include/glm \
           -I./include/GLFW \
           -I./include/glad \
           -I./include/assimp \
           -I./include/imgui

# Libraries to link: extracted from <AdditionalDependencies>
LIBS = -lglfw -lGL -lGLU

# Output executable name
TARGET = tarea-1

# Directory for intermediate object files
OBJ_DIR = obj

# --- Source Files ---

# Source files: extracted from <ItemGroup><ClCompile Include="...">
SRCS = src/glad.c \
       src/main.cpp \
       src/PixelRender.cpp \
       include/imgui/backends/imgui_impl_glfw.cpp \
       include/imgui/backends/imgui_impl_opengl3.cpp \
       include/imgui/imgui.cpp \
       include/imgui/imgui_demo.cpp \
       include/imgui/imgui_draw.cpp \
       include/imgui/imgui_tables.cpp \
       include/imgui/imgui_widgets.cpp

# Object files: replace .cpp/.c with .o and prepend the object directory
OBJS = $(SRCS:%.cpp=$(OBJ_DIR)/%.o)
OBJS := $(OBJS:%.c=$(OBJ_DIR)/%.o)

# --- Targets ---

# Default target: builds the executable
all: $(TARGET)

# Target to create the executable from object files
$(TARGET): $(OBJS)
	@echo "Linking $(TARGET)..."
	$(CXX) $(OBJS) $(LDIR) $(LIBS) -o $@

# Rule for building object files from C++ source files (*.cpp)
# The '-MMD' flag generates dependency files (*.d)
$(OBJ_DIR)/%.o: %.cpp | $(OBJ_DIR)
	@mkdir -p $(OBJ_DIR)/$(dir $<)
	@echo "Compiling $<..."
	$(CXX) $(CXXFLAGS) $(INCLUDES) -c $< -o $@ -MMD

# Rule for building object files from C source files (*.c)
$(OBJ_DIR)/%.o: %.c | $(OBJ_DIR)
	@mkdir -p $(OBJ_DIR)/$(dir $<)
	@echo "Compiling $<..."
	$(CXX) $(CXXFLAGS) $(INCLUDES) -c $< -o $@ -MMD

# Target to create the object file directory structure
$(OBJ_DIR):
	@echo "Creating object directory: $(OBJ_DIR)"
	@mkdir -p $(OBJ_DIR)

# Clean target: removes generated files
.PHONY: clean
clean:
	@echo "Cleaning up build artifacts..."
	@rm -rf $(OBJ_DIR) $(TARGET)

# Include dependency files (generated by -MMD)
-include $(OBJS:.o=.d)
